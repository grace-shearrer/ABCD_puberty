---
title: "TOS 2020 analysis: plots"
output: html_notebook
---

```{r}
library(ggplot2)
library(ggpubr)
```


```{r}
load("~/Google Drive/ABCD/ABCD_puberty/_data/TOS2020/TOS2020_chp3_1.RData")
```

# Anticipation compared to reward in the caudate
```{r}
caudate_L <-ggplot(subcort_RwLsAn, aes(x=PCSum, y=CaudateAntVsRewL, color = central_ob)) +
    geom_point(shape=1) +    # Use hollow circles
    geom_smooth(method=lm) + theme_classic()    # Don't add shaded confidence region

caudate_Lv <-ggplot(subcort_RwLsAn, aes(x=PCScore, y=CaudateAntVsRewL, color = central_ob)) +
    geom_violin() + theme_classic()    # Don't add shaded confidence region


caudate_R <-ggplot(subcort_RwLsAn, aes(x=PCSum, y=CaudateAntVsRewR, color = central_ob)) +
    geom_point(shape=1) +    # Use hollow circles
    geom_smooth(method=lm) + theme_classic()    # Don't add shaded confidence region

caudate_Rv <-ggplot(subcort_RwLsAn, aes(x=PCScore, y=CaudateAntVsRewR, color = central_ob)) +
    geom_violin() + theme_classic()    # Don't add shaded confidence region

ggarrange(caudate_L, caudate_R,   ncol = 1, nrow = 2)
```

# Reward compared to Loss in the caudate
```{r}
caudate_L2 <-ggplot(subcort_, aes(x=PCSum, y=CaudateRewVsLossL, color = central_ob)) +
    geom_point(shape=1) +    # Use hollow circles
    geom_smooth(method=lm) + theme_classic()    # Don't add shaded confidence region

caudate_L2v <-ggplot(subcort_, aes(x=PCScore, y=CaudateRewVsLossL, color = central_ob)) +
    geom_violin() + theme_classic()    # Don't add shaded confidence region


caudate_R2 <-ggplot(subcort_, aes(x=PCSum, y=CaudateRewVsLossR, color = central_ob)) +
    geom_point(shape=1) +    # Use hollow circles
    geom_smooth(method=lm) + theme_classic()    # Don't add shaded confidence region


mytable <- xtabs(~PCScore+central_ob, data=subcort_RwLsAn)
ftable(mytable) # print table

describeBy(subcort_$CaudateRewVsLossR, subcort_$central_ob)

caudate_R2v <-ggplot(subcort_, aes(x=central_ob, y=CaudateRewVsLossR, color = central_ob)) +
    geom_violin() + theme_classic()    # Don't add shaded confidence region
caudate_R2v

ggarrange(caudate_L2, caudate_R2,   ncol = 1, nrow = 2)
```

